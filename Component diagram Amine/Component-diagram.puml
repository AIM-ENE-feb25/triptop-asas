@startuml
!include https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Component.puml
title Component Diagram – TripTop Backend

Container(frontend, "Frontend", "React, JavaScript", "Stelt gebruikers in staat om reizen te plannen, boeken, beheren en betalen")

System_Boundary(backendSystem, "Backend [Java, Spring Boot]") {
    Component(loginController, "Login Controller", "Spring MVC", "Verwerkt login")
    Component(paymentController, "Payment Controller", "Spring MVC", "Verwerkt betalingen")
    Component(tripController, "Trip Controller", "Spring MVC", "Verwerkt reisplanningen")

    Component(loginService, "Login Service", "Spring Service", "Doet de businesslogica van de authenticatie en autorisatie")
    Component(paymentService, "Payment Service", "Spring Service", "Doet de businesslogica van de betalingen")
    Component(tripService, "Trip Service", "Spring Service", "Doet de businesslogica van de reisplanning en -informatie")

    Component(userRepository, "User Repository", "Spring Data JPA", "Slaat gebruikersgegevens op in de database")
    Component(tripRepository, "Trip Repository", "Spring Data JPA", "Slaat complete trips op (inclusief boekingen) in de database")
    Component(paymentRepository, "payment Repository", "Spring Data JPA", "Slaat betalingen op in de database")


    Component(tripAdapter, "Trip Service Adapter", "Spring Boot", "Abstracteert externe reis- en boekingsservices")
    Component(authAdapter, "Auth Service Adapter", "Spring Boot", "Abstracteert externe authenticatiediensten")
    Component(paymentAdapter, "Payment Service Adapter", "Spring Boot", "Abstracteert externe betalingsdiensten")



}

Container(database, "Database", "?", "Slaat reizen, bouwstenen en gebruikersgegevens op")

System_Ext(identity_provider, "WireMock API", "Simuleert centrale identiteitsverificatie en SSO")
System_Ext(payment_provider, "Stripe API", "Faciliteert veilige online betalingstransacties")
System_Ext(booking, "Booking API", "Biedt toegang tot accommodaties, boekingsmogelijkheden en autoverhuur")
System_Ext(vervoer_services, "NS API", "Levert real-time reisinformatie voor treinreizen")
System_Ext(routeplanner_service, "Maps API", "Biedt geavanceerde routeplanning en alternatieve reisopties")
System_Ext(activiteiten_services, "Tripadvisor API", "Verstrekt informatie over lokale attracties, excursies en bezienswaardigheden")
System_Ext(eten_services, "UberEats API", "Biedt een overzicht van restaurants, cafés en andere eet-/drinkmogelijkheden")

    Rel(loginService, identity_provider, "Authenticeert gebruikers", "REST/JSON")
    Rel(paymentService, payment_provider, "Verwerkt betalingen", "REST/JSON")

    Rel(tripService, booking, "Haalt boekingsmogelijkheden op en boekt", "REST/JSON")
    Rel(tripService, vervoer_services, "Haalt reisinformatie (trein) op", "REST/JSON")

    Rel(tripService, routeplanner_service, "Haalt routes op", "REST/JSON")
    Rel(tripService, activiteiten_services, "Haalt activiteiten/excursies op", "REST/JSON")
    Rel(tripService, eten_services, "Haalt eet-/drinkmogelijkheden op", "REST/JSON")
    Rel(frontend, loginController, "Stuurt inlogverzoeken", "HTTPS")
    Rel(frontend, paymentController, "Stuurt betalingsverzoeken", "HTTPS")
    Rel(frontend, tripController, "Stuurt reisplanningsverzoeken", "HTTPS")

    Rel(tripRepository,database,"Leest/ Schrijft naar")
    Rel(userRepository,database,"Leest/ Schrijft naar")
    Rel(loginController, loginService, "Stuurt inlogverzoeken", "JSON/HTTP")
    Rel(paymentController, paymentService, "Stuurt betalingsverzoeken", "JSON/HTTP")
    Rel(tripController, tripService, "Stuurt reisplanningsverzoeken", "JSON/HTTP")

    Rel(loginService, userRepository, "Leest/schrijft gebruikersdata", "JDBC/SQL")
    Rel(tripService, tripRepository, "Leest/schrijft tripdata", "JDBC/SQL")
    Rel(paymentService, paymentRepository, "Leest/schrijft betalingsdata", "JDBC/SQL")
    Rel(paymentRepository,database,"Leest/ Schrijft naar")

    Rel(tripService, tripAdapter, "Haalt reis- en boekingsinformatie op", "REST/JSON")
    Rel(loginService, authAdapter, "Haalt gebruikersgegevens op", "REST/JSON")
    Rel(paymentService, paymentAdapter, "Verwerkt betalingen", "REST/JSON")

    Rel(tripAdapter, booking, "Haalt boekingsmogelijkheden op en boekt", "REST/JSON")
    Rel(authAdapter, identity_provider, "Authenticeert gebruikers", "REST/JSON")
    Rel(paymentAdapter, payment_provider, "Verwerkt betalingen", "REST/JSON")
    Rel(tripAdapter, vervoer_services, "Haalt reisinformatie (trein) op", "REST/JSON")
    Rel(tripAdapter, routeplanner_service, "Haalt routes op", "REST/JSON")
    Rel(tripAdapter, activiteiten_services, "Haalt activiteiten/excursies op", "REST/JSON")
    Rel(tripAdapter, eten_services, "Haalt eet-/drinkmogelijkheden op", "REST/JSON")




@enduml
